webpackJsonp([8],{"7Caa":function(t,e){},Rmja:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("TIfe");var a=n("Tnm7"),r=n("NYxO"),s=n("ytf2"),i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t};function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function a(r,s){try{var i=e[r](s),o=i.value}catch(t){return void n(t)}if(!i.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})}}var c={props:{value:{type:Boolean,default:!1},dataInfo:{type:Object,default:function(){}},curCancel:{type:Object,default:function(){}}},data:function(){return{dialogVisible:this.value,balance:0,price:""}},watch:{value:function(t){var e=this;this.dialogVisible=t,this.price="",Object(s.b)(),this.$nextTick(o(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new web3.eth.Contract(JSON.parse(a.s),a.p),t.next=3,n.methods.balanceOf(e.mateMaskToken).call().catch(function(t){if(t)return e.balance=0,!1});case 3:e.balance=t.sent,e.balance=web3.utils.fromWei(e.balance),e.balance=parseFloat(e.balance.substring(0,e.balance.indexOf(".")+5));case 6:case"end":return t.stop()}},t,e)})))},price:function(t){t&&(t=(t+"").match(/^\d*(\.?\d{0,4})/g)[0]||null,this.price=t,parseFloat(this.price)>parseFloat(this.balance)&&(this.price=this.balance))}},computed:i({},Object(r.c)({language:function(t){return t.app.language},mateMaskToken:function(t){return t.app.mateMaskToken}})),mounted:function(){var t=this;return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},e,t)}))()},methods:{handleClose:function(t){this.$emit("input",!1)},onConfirm:function(){var t=this;return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(parseFloat(t.price)){e.next=2;break}return e.abrupt("return");case 2:t.$emit("STAKE",t.price);case 3:case"end":return e.stop()}},e,t)}))()}}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{title:"Stake to NERA LP",visible:t.dialogVisible,"append-to-body":"",center:"","lock-scroll":"",width:"500px","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("div",{staticClass:"txt1"},[t._v(t._s(t.mateMaskToken))]),t._v(" "),n("div",{staticClass:"txt1"},[t._v("NERA Balance："+t._s(t.balance))]),t._v(" "),n("div",{staticClass:"input-div"},[n("div",{staticClass:"desc"},[t._v("Stake NERA Amount")]),t._v(" "),n("el-input",{model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),t._v(" "),n("div",{staticClass:"tips"}),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticClass:"btn3",attrs:{disabled:t.price<=0},on:{click:t.onConfirm}},[t._v("\n              Stake\n          ")])],1)])],1)},staticRenderFns:[]};var l=n("VU/8")(c,u,!1,function(t){n("gA7f")},"data-v-4a844261",null).exports,v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t};var d={props:{value:{type:Boolean,default:!1},balanceOf:{type:Number,default:0},earned:{type:Number,default:0}},data:function(){return{dialogVisible:this.value,sSellOrder:null,sSellSig:null}},watch:{value:function(t){this.dialogVisible=t}},computed:v({},Object(r.c)({mateMaskToken:function(t){return t.app.mateMaskToken}}),{price:function(){return this.balanceOf+this.earned}}),methods:{handleClose:function(t){this.$emit("input",!1)},onConfirm:function(){var t,e=this;return(t=regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$emit("WITHDRAW",!0);case 1:case"end":return t.stop()}},t,e)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function a(r,s){try{var i=e[r](s),o=i.value}catch(t){return void n(t)}if(!i.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})})()}}},f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{title:"Withdraw to your wallet",visible:t.dialogVisible,"append-to-body":"",center:"","lock-scroll":"",width:"500px","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("div",{staticClass:"txt1"},[t._v(t._s(t.mateMaskToken))]),t._v(" "),n("div",{staticClass:"txt1"},[t._v("Staked："+t._s(t.balanceOf))]),t._v(" "),n("div",{staticClass:"txt1"},[t._v("Pending Reward："+t._s(t.earned))]),t._v(" "),n("div",{staticClass:"input-div"},[n("div",{staticClass:"desc"},[t._v("Withdraw Amount")]),t._v(" "),n("el-input",{attrs:{disabled:!0},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),t._v(" "),n("div",{staticClass:"tips"},[t._v("All Stake Amount will withdraw your wallet")]),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("div",{staticClass:"btn",on:{click:t.onConfirm}},[t._v("\n              Withdraw\n          ")])])])],1)},staticRenderFns:[]};function p(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function a(r,s){try{var i=e[r](s),o=i.value}catch(t){return void n(t)}if(!i.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})}}var m={components:{stake:l,WithDraw:n("VU/8")(d,f,!1,function(t){n("mHcu")},"data-v-29c99762",null).exports},data:function(){return{showWithDraw:!1,showStake:!1,isRequest:!1,time:0,timeId:null,address:"",abi:"",contract:null,rewardRate:0,totalSupply:0,balanceOf:0,earned:0,realRate:0}},watch:{mateMaskToken:function(){}},computed:(Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t})({},Object(r.c)({mateMaskToken:function(t){return t.app.mateMaskToken}}),{canWithDraw:function(){return!(this.earned+this.balanceOf)}}),mounted:function(){var t=this.$route.query.address;t||(t=a.c)},methods:{withDraw:function(){var t=this;return p(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.$event.$emit("SHOW-LOADING",!0),e.next=3,web3.eth.getGasPrice();case 3:return n=e.sent,console.log("推荐gas费==="+n),e.next=7,t.contract.methods.withdrawAndGetReward().send({from:t.mateMaskToken,gasPrice:n},function(e,n){if(e)return t.$message.error("提现失败"),t.$event.$emit("SHOW-LOADING",!1),!1;t.showWithDraw=!1,t.$message("提现成功，等待区块确认")});case 7:t.$message.success("提现成功"),t.refresh(),t.$event.$emit("SHOW-LOADING",!1);case 10:case"end":return e.stop()}},e,t)}))()},stake:function(t){var e=this;return p(regeneratorRuntime.mark(function n(){var r,s,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.$event.$emit("SHOW-LOADING",!0),n.next=3,web3.eth.getGasPrice();case 3:return r=n.sent,console.log("推荐gas费==="+r),t=web3.utils.toWei(t),s=new web3.eth.Contract(JSON.parse(a.s),a.p),n.next=9,s.methods.allowance(e.mateMaskToken,e.address).call();case 9:if("0"!=(i=n.sent)){n.next=17;break}return console.log("跳转ERC20授权!"),n.next=14,s.methods.approve(e.address,"1000000000000000000000000000000000000000000").send({from:e.mateMaskToken,gasPrice:r},function(t,n){if(t)return Vue.prototype.$event.$emit("SHOW-LOADING",!1),console.log("授权报错"),Vue.prototype.$message.error(i18n.t("message.assets_lang_90")),e.$event.$emit("SHOW-LOADING",!1),!1});case 14:return n.next=16,s.methods.allowance(e.mateMaskToken,e.address).call();case 16:i=n.sent;case 17:if("0"!=i){n.next=23;break}return console.log("ERC20未授权!"),e.$event.$emit("SHOW-LOADING",!1),n.abrupt("return",!1);case 23:console.log("ERC20已授权!");case 24:return n.next=26,e.contract.methods.stake(t).send({from:e.mateMaskToken,gasPrice:r},function(t,n){if(t)return e.$message.error("质押失败"),e.$event.$emit("SHOW-LOADING",!1),!1;e.showStake=!1,e.$message("质押成功，等待区块确认")});case 26:e.$message.success("质押成功"),e.refresh(),e.$event.$emit("SHOW-LOADING",!1);case 29:case"end":return n.stop()}},n,e)}))()},refresh:function(){var t=this;return p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isRequest){e.next=2;break}return e.abrupt("return");case 2:return t.isRequest=!0,e.next=5,t.initData();case 5:t.isRequest=!1,t.time=0,t.startTime();case 8:case"end":return e.stop()}},e,t)}))()}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"container"},[a("div",{staticClass:"item-div"},[a("el-tooltip",{attrs:{effect:"light","visible-arrow":!1,content:"Displayed data will auto-refresh after "+(60-t.time)+" seconds.Click this circle to update manually.",placement:"bottom-end"}},[a("div",{staticClass:"time-circle",on:{click:t.refresh}},[a("el-progress",{attrs:{type:"circle","stroke-width":2,"show-text":!1,width:20,percentage:100*t.time/60}})],1)])],1),t._v(" "),a("el-row",{staticClass:"top"},[a("el-col",{staticClass:"coin-container",attrs:{span:8}},[a("div",{staticClass:"coin"},[a("img",{attrs:{src:n("jzCB"),alt:""}}),t._v(" "),a("div",[t._v("NERA")])]),t._v(" "),a("div",{staticClass:"line"}),t._v(" "),a("div",{staticClass:"coin"},[a("img",{attrs:{src:n("jzCB"),alt:""}}),t._v(" "),a("div",[t._v("NERA")])])]),t._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"txt1"},[t._v("PENDING REWARD")]),t._v(" "),a("div",{staticClass:"txt2"},[t._v(t._s(t.earned))])]),t._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"txt1"},[t._v("STAKED")]),t._v(" "),a("div",{staticClass:"txt2"},[t._v(t._s(t.balanceOf))])]),t._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"txt1"},[t._v("APR")]),t._v(" "),a("div",{staticClass:"txt2"},[t._v(t._s(t.realRate)+" %")])]),t._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"txt1"},[t._v("LIQUIDITY")]),t._v(" "),a("div",{staticClass:"txt2"},[t._v(t._s(t.totalSupply))])])],1),t._v(" "),a("div",{staticClass:"botton"},[a("el-row",{attrs:{type:"flex"}},[a("div",{staticClass:"item"},[a("div",{staticClass:"item-container"},[a("div",{staticClass:"item-title"},[t._v("TOTOAL NERA")]),t._v(" "),a("div",{staticClass:"txt-btn"},[a("div",{staticClass:"txt2"},[t._v("\n                "+t._s(parseFloat((t.earned+t.balanceOf).toFixed(4)))+"\n              ")]),t._v(" "),a("el-button",{staticClass:"btn3",attrs:{disabled:t.canWithDraw},on:{click:function(e){t.showWithDraw=!0}}},[t._v("\n                Withdraw\n              ")])],1)])]),t._v(" "),a("div",{staticClass:"item"},[a("div",{staticClass:"item-container"},[a("div",{staticClass:"item-title"},[t._v("START STAKING")]),t._v(" "),t.mateMaskToken?a("div",{staticClass:"txt-btn"},[a("div",{staticClass:"txt3 line1hidden"},[t._v("\n                "+t._s(t.mateMaskToken)+"\n              ")]),t._v(" "),a("div",{staticClass:"btn btn-stake",on:{click:function(e){t.showStake=!0}}},[t._v("Stake")])]):a("div",{staticClass:"btn btn-connect",on:{click:function(e){return t.$router.push("/metamask")}}},[t._v("\n              Connect Wallet\n            ")])])])])],1)],1),t._v(" "),a("with-draw",{attrs:{earned:t.earned,balanceOf:t.balanceOf},on:{WITHDRAW:t.withDraw},model:{value:t.showWithDraw,callback:function(e){t.showWithDraw=e},expression:"showWithDraw"}}),t._v(" "),a("stake",{on:{STAKE:t.stake},model:{value:t.showStake,callback:function(e){t.showStake=e},expression:"showStake"}})],1)},staticRenderFns:[]};function b(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function a(r,s){try{var i=e[r](s),o=i.value}catch(t){return void n(t)}if(!i.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})}}var w={data:function(){return{showWithDraw:!1,showStake:!1,isRequest:!1,time:0,timeId:null,address:"",abi:"",contract:null,rewardRate:0,totalSupply:0,balanceOf:0,earned:0,realRate:0}},watch:{mateMaskToken:function(){this.initData()}},components:{StakeItem:n("VU/8")(m,h,!1,function(t){n("qsl3")},"data-v-91a32168",null).exports},computed:(Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t})({},Object(r.c)({mateMaskToken:function(t){return t.app.mateMaskToken}}),{canWithDraw:function(){return!(this.earned+this.balanceOf)}}),mounted:function(){var t=this;return b(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initConfig();case 2:case"end":return e.stop()}},e,t)}))()},beforeDestroy:function(){clearInterval(this.timeId)},methods:{toInvite:function(){var t=this;return b(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.mateMaskToken){e.next=3;break}return t.$router.push("/metamask"),e.abrupt("return");case 3:t.$router.push("/invite-staking");case 4:case"end":return e.stop()}},e,t)}))()},initConfig:function(){var t=this;return b(regeneratorRuntime.mark(function e(){var n,a,r,i,o,c,u,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$api.GetSystemConfig({sAppId:"Erax-dev",sKey1:"Stake"});case 2:for(n=e.sent,a=n.vList,r=!0,i=!1,o=void 0,e.prev=7,c=a[Symbol.iterator]();!(r=(u=c.next()).done);r=!0)"stakeAbi"===(l=u.value).sKey2?t.abi=l.sValue:t.address=l.sValue;e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),i=!0,o=e.t0;case 15:e.prev=15,e.prev=16,!r&&c.return&&c.return();case 18:if(e.prev=18,!i){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:Object(s.b)(),t.contract=new web3.eth.Contract(JSON.parse(t.abi),t.address),t.startTime();case 26:case"end":return e.stop()}},e,t,[[7,11,15,23],[16,,18,22]])}))()},startTime:function(){var t=this;clearInterval(this.timeId),this.timeId=setInterval(function(){t.time++,t.time>=60&&(clearInterval(t.timeId),t.refresh())},1e3)},initData:function(){var t=this;return b(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.contract){e.next=2;break}return e.abrupt("return");case 2:if(!t.mateMaskToken){e.next=11;break}return e.next=5,t.contract.methods.balanceOf(t.mateMaskToken).call();case 5:return t.balanceOf=e.sent,t.balanceOf=parseFloat(web3.utils.fromWei(t.balanceOf)),e.next=9,t.contract.methods.earned(t.mateMaskToken).call();case 9:t.earned=e.sent,t.earned=parseFloat(parseFloat(web3.utils.fromWei(t.earned)).toFixed(4));case 11:return e.next=13,t.contract.methods.getRewardRate().call();case 13:return t.rewardRate=e.sent,t.rewardRate=parseFloat(web3.utils.fromWei(t.rewardRate)),e.next=17,t.contract.methods.totalSupply().call();case 17:return t.totalSupply=e.sent,t.totalSupply=parseFloat(parseFloat(web3.utils.fromWei(t.totalSupply)).toFixed(4)),n=t.totalSupply?t.totalSupply:1,t.realRate=(31536e5*t.rewardRate/n).toFixed(2),e.abrupt("return",!0);case 22:case"end":return e.stop()}},e,t)}))()},refresh:function(){var t=this;return b(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isRequest){e.next=2;break}return e.abrupt("return");case 2:return t.isRequest=!0,e.next=5,t.initData();case 5:t.isRequest=!1,t.time=0,t.startTime();case 8:case"end":return e.stop()}},e,t)}))()}}},k={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"staking"},[e("div",{staticClass:"header"},[e("div",{staticClass:"title"},[this._v("Staking")]),this._v(" "),e("div",{staticClass:"invite-btn",on:{click:this.toInvite}},[e("i",{staticClass:"iconfont icon-yaoqing1"}),this._v("\n            My lnvite...\n        ")])]),this._v(" "),this._l(3,function(t,n){return e("stake-item",{key:n})})],2)},staticRenderFns:[]};var g=n("VU/8")(w,k,!1,function(t){n("VWa1"),n("7Caa")},"data-v-1622442f",null);e.default=g.exports},VWa1:function(t,e){},gA7f:function(t,e){},mHcu:function(t,e){},qsl3:function(t,e){}});