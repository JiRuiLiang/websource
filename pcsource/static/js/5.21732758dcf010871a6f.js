webpackJsonp([5],{"ZI/r":function(t,e){},gKXW:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Xxa5"),a=n.n(i),o=n("exGp"),r=n.n(o),s={components:{},name:"ItemDetail",data:function(){return{dialogVisible:!1,onLine:!1,iItemId:0,dataInfo:{},iCollectionId:0,form:{price:""}}},mounted:function(){var t=this.$route.query,e=t.iItemId,n=t.iCollectionId;this.iItemId=parseInt(e),this.iCollectionId=parseInt(n),this.initView()},methods:{getStatus:function(){if(!this.dataInfo.iItemStatus)return"";switch(this.dataInfo.iItemStatus){case 1:return"新创建未上架";case 2:return"已上架未发布到公链";case 3:return"已上架发布到公链";case 4:return"已购买未完结";case 5:return"购买完结"}},initView:function(){var t=this;return r()(a.a.mark(function e(){var n,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$api.GetItemDetail({iItemId:t.iItemId,iUserId:123,iCollectionId:t.iCollectionId});case 2:n=e.sent,i=n.stItem,t.dataInfo=i;case 5:case"end":return e.stop()}},e,t)}))()},onClickCollection:function(){this.form.imageUrl&&this.form.name&&(this.dialogVisible=!1)},onListing:function(){var t=this;return r()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.metacoin.methods.listNFT("0x7Fcc94738a6f931909FdA435C8D0ea2B30351193",t.dataInfo.stChianInfo.sTokenId,"").send({from:"0x7Fcc94738a6f931909FdA435C8D0ea2B30351193"},function(){var e=r()(a.a.mark(function e(n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("--------"+i),n){e.next=8;break}return e.next=4,t.$api.CreateSell({iItemId:t.iItemId,iUserId:123,iCollectionId:t.iCollectionId,dPrice:t.form.price});case 4:e.sent,t.initView(),t.dialogVisible=!1,setTimeout(function(){t.$api.UpdateItemStatus({iItemId:t.iItemId,iUserId:123,iCollectionId:t.iCollectionId,iStatus:3}).then(function(e){t.initView()})},2e3);case 8:case"end":return e.stop()}},e,t)}));return function(t,n){return e.apply(this,arguments)}}()),window.metacoin.methods.totalSupply().call(null,function(t,e){console.log("+++++",e)});case 2:case"end":return e.stop()}},e,t)}))()},buyItem:function(){var t=this;return r()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.metacoin.methods.fixedPriceExchange("0x7Fcc94738a6f931909FdA435C8D0ea2B30351193","0x872617c16060d5d1c621E95eBD60138166eabEb3",t.dataInfo.stChianInfo.sTokenId).send({from:"0x7Fcc94738a6f931909FdA435C8D0ea2B30351193"},function(){var e=r()(a.a.mark(function e(n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("--------"+i),n){e.next=6;break}return e.next=4,t.$api.UpdateItemStatus({iItemId:t.iItemId,iUserId:123,iCollectionId:t.iCollectionId,iStatus:4});case 4:t.initView(),setTimeout(function(){t.$api.UpdateItemStatus({iItemId:t.iItemId,iUserId:123,iCollectionId:t.iCollectionId,iStatus:5}).then(function(e){t.initView()})},3e3);case 6:case"end":return e.stop()}},e,t)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,t)}))()},onCheck:function(){window.metacoin.methods.totalSupply().call(null,function(t,e){console.log("+++++",e)})},onClickCancel:function(){var t=this;return r()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.metacoin.methods.cancelListNFT(t.dataInfo.stChianInfo.sTokenId).send({from:"0x7Fcc94738a6f931909FdA435C8D0ea2B30351193"},function(){var e=r()(a.a.mark(function e(n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("--------"+i),n){e.next=5;break}return e.next=4,t.$api.UpdateItemStatus({iItemId:t.iItemId,iUserId:123,iCollectionId:t.iCollectionId,iStatus:1});case 4:t.initView();case 5:case"end":return e.stop()}},e,t)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,t)}))()},handleAvatarSuccess:function(t,e){this.form.imageUrl=URL.createObjectURL(e.raw)},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,n=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),n||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&n}}},c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"item-detail"},[n("img",{attrs:{src:t.dataInfo.sItemDataUrl,alt:""}}),t._v(" "),n("div",[t._v("name: "+t._s(t.dataInfo.sItemName))]),t._v(" "),n("div",[t._v("\n    address:\n    "+t._s(t.dataInfo.stChianInfo&&t.dataInfo.stChianInfo.sContractAddress)+"\n  ")]),t._v(" "),n("div",[t._v("\n    token: "+t._s(t.dataInfo.stChianInfo&&t.dataInfo.stChianInfo.sTokenId)+"\n  ")]),t._v(" "),n("div",[t._v("交易状态: "+t._s(t.getStatus()))]),t._v(" "),n("el-button",{staticClass:"btn",staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:t.onCheck}},[t._v("Check")]),t._v(" "),t.dataInfo.iItemStatus===t.itemStatus.ItemStatus_Create?n("el-button",{staticClass:"btn",staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("Sell")]):n("div",[n("div",[t._v("Current price ETH "+t._s(t.dataInfo.dCurrentPrice))]),t._v(" "),t.dataInfo.iItemStatus===t.itemStatus.ItemStatus_Sell_Done?n("el-button",{staticClass:"btn",staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:t.buyItem}},[t._v("Buy Now")]):t._e(),t._v(" "),t.dataInfo.iItemStatus===t.itemStatus.ItemStatus_Sell_Done?n("el-button",{staticClass:"btn",staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:t.onClickCancel}},[t._v("Cancel")]):t._e()],1),t._v(" "),n("el-dialog",{attrs:{title:"Sell",visible:t.dialogVisible,width:"500px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[n("el-form-item",[n("el-row",[t._v("Set Price")]),t._v(" "),n("el-input",{model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.onListing}},[t._v("Posting Your Listing >")])],1)],1)],1)},staticRenderFns:[]};var l=n("VU/8")(s,c,!1,function(t){n("ZI/r")},"data-v-e08979d6",null);e.default=l.exports}});