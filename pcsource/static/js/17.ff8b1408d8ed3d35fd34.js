webpackJsonp([17],{T6vj:function(e,t){},seP7:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("pXgp"),a=r("WnJJ"),i=r("Pgpu"),o=r.n(i),n=r("NYxO"),c=r("JrLM"),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e};function m(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function s(a,i){try{var o=t[a](i),n=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(n).then(function(e){s("next",e)},function(e){s("throw",e)});e(n)}("next")})}}var u={name:"shopEdit",components:{ElUploader:a.a,VueUeditorWrap:o.a},data:function(){return{fileUrl:s.a,rules:this.getRules(),form:{},vLinks:{},eraxDictData:[],eraxDictDatas:{},myConfig:this.$store.state.app.ueditorConfig}},computed:l({},Object(n.b)(["token"])),mounted:function(){var e=this;return m(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.eraxGetDictData();case 2:return t.next=4,e.getCollectionsDetail();case 4:case"end":return t.stop()}},t,e)}))()},methods:{getCollectionsDetail:function(){var e=this;return m(regeneratorRuntime.mark(function t(){var r,s,a,i,o,n,c,m,u,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={iUserId:1002,iCollectionId:+e.$route.query.iCollectionId,sWallet:e.token},t.next=3,e.$api.GetCollectionDetail(r);case 3:if(s=t.sent,!(a=s.stCollection)){t.next=29;break}for(e.form=l({},a,{iCategory:parseInt(a.stCategory.sDictValue)}),i={},o=!0,n=!1,c=void 0,t.prev=11,m=a.vLinks[Symbol.iterator]();!(o=(u=m.next()).done);o=!0)f=u.value,i[f.skey]=f.sUrl;t.next=19;break;case 15:t.prev=15,t.t0=t.catch(11),n=!0,c=t.t0;case 19:t.prev=19,t.prev=20,!o&&m.return&&m.return();case 22:if(t.prev=22,!n){t.next=25;break}throw c;case 25:return t.finish(22);case 26:return t.finish(19);case 27:e.vLinks=i,e.$nextTick(function(){e.$refs.form.clearValidate()});case 29:case"end":return t.stop()}},t,e,[[11,15,19,27],[20,,22,26]])}))()},eraxGetDictData:function(){var e=this;return m(regeneratorRuntime.mark(function t(){var r,s,a,i,o,n,c,m,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$api.GetDictData({iDictType:1});case 2:if(!(r=t.sent).vDictData){t.next=27;break}for(s=r.vDictData.map(function(e){return l({},e,{sDictText:"message."+(r.sDictType+e.iDictSort)})}),e.eraxDictData=s,a={},i=!0,o=!1,n=void 0,t.prev=10,c=s[Symbol.iterator]();!(i=(m=c.next()).done);i=!0)u=m.value,a[+u.sDictValue]=u;t.next=18;break;case 14:t.prev=14,t.t0=t.catch(10),o=!0,n=t.t0;case 18:t.prev=18,t.prev=19,!i&&c.return&&c.return();case 21:if(t.prev=21,!o){t.next=24;break}throw n;case 24:return t.finish(21);case 25:return t.finish(18);case 26:e.eraxDictDatas=a;case 27:case"end":return t.stop()}},t,e,[[10,14,18,26],[19,,21,25]])}))()},getRules:function(){return{sLogoImg:[{required:!0,message:"请上传LOGO",trigger:["blur","change"]}],sCollectionName:[{required:!0,message:"店铺名称不能为空",trigger:"blur"}],iCategory:[{type:"number",required:!0,message:"分类不能为空",trigger:["blur","change"]}],sUrl:[{required:!1,message:"URL不能为空",trigger:["blur","change"]},{pattern:/^[0-9a-z-_]+$/,message:"URL格式错误",trigger:"blur"}],sDescription:[{required:!0,message:"店铺描述不能为空",trigger:["blur","change"]}]}},handleEdit:function(){var e=this;return m(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.a)();case 2:e.$refs.form.validate(function(){var t=m(regeneratorRuntime.mark(function t(r){var s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=6;break}return s=l({iUserId:1002},e.form,{sWallet:e.token}),t.next=4,e.$api.EditCollection(s);case 4:e.$message({type:"success",message:"修改成功!"}),e.$router.go(-1);case 6:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}},t,e)}))()},handleDelete:function(){var e=this;return m(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.a)();case 2:e.$confirm("此操作将永久删除该店铺, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:e.$t("message.assets_lang_11"),type:"warning"}).then(m(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$api.DeleteCollection({iUserId:1002,iCollectionId:e.form.iCollectionId,sWallet:e.token});case 2:e.$message({type:"success",message:"删除成功!"}),e.$router.replace({name:"collectionsList"});case 4:case"end":return t.stop()}},t,e)})));case 3:case"end":return t.stop()}},t,e)}))()},handleSuccessLogo:function(e){this.$set(this.form,"sLogoImg",e),this.$refs.form.validateField("sLogoImg")},handleSuccessFeatured:function(e){this.$set(this.form,"sFeaturedImg",e),this.$refs.form.validateField("sFeaturedImg")},handleRemoveLogo:function(){this.$set(this.form,"sLogoImg","")},handleRemoveFeatured:function(){this.$set(this.form,"sFeaturedImg","")}}},f={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page-edit"},[r("div",{staticClass:"erax-page-header"},[r("div",{staticClass:"erax-page-layout"},[r("a",{staticClass:"erax-back",on:{click:function(t){return e.$router.go(-1)}}},[r("i",{staticClass:"el-icon-arrow-left"}),e._v(" 返回")])])]),e._v(" "),r("div",{staticClass:"form-page-box"},[r("div",{staticClass:"header"},[r("h1",{staticClass:"header-title"},[e._v(e._s(e.$t("message.Other_19")))])]),e._v(" "),r("el-form",{ref:"form",staticClass:"edit-form",attrs:{model:e.form,rules:e.rules}},[r("el-form-item",{staticClass:"form-item",attrs:{prop:"sLogoImg"}},[r("div",{staticClass:"form-item-header"},[r("h4",{staticClass:"form-item-title"},[e._v("LOGO *")]),e._v(" "),r("h4",{staticClass:"form-item-des"},[e._v("("+e._s(e.$t("message.Accounts_43"))+": 350 x 350 )")])]),e._v(" "),r("div",{staticClass:"form-content"},[r("el-uploader",{attrs:{imgUrl:e.form.sLogoImg,onSuccess:e.handleSuccessLogo,onRemove:e.handleRemoveLogo}})],1)]),e._v(" "),r("el-form-item",{staticClass:"form-item"},[r("div",{staticClass:"form-item-header"},[r("h4",{staticClass:"form-item-title"},[e._v(e._s(e.$t("message.Accounts_22")))]),e._v(" "),r("h4",{staticClass:"form-item-des"},[e._v(e._s(e.$t("message.Other_14"))+"，"+e._s(e.$t("message.Accounts_43"))+": 1266 x 300。")])]),e._v(" "),r("div",{staticClass:"form-content"},[r("el-uploader",{attrs:{width:"250",height:"120",imgUrl:e.form.sFeaturedImg,onSuccess:e.handleSuccessFeatured,onRemove:e.handleRemoveFeatured}})],1)]),e._v(" "),r("el-form-item",{staticClass:"form-item",attrs:{prop:"sCollectionName"}},[r("div",{staticClass:"form-item-header"},[r("h4",{staticClass:"form-item-title"},[e._v(e._s(e.$t("message.Collections_09"))+" *")])]),e._v(" "),r("el-input",{attrs:{placeholder:"输入店铺名称，如：盒马动画原创动漫2021幅",maxlength:64},model:{value:e.form.sCollectionName,callback:function(t){e.$set(e.form,"sCollectionName",t)},expression:"form.sCollectionName"}})],1),e._v(" "),r("el-form-item",{staticClass:"form-item",attrs:{prop:"sUrl"}},[r("div",{staticClass:"form-item-header"},[r("h4",{staticClass:"form-item-title"},[e._v(e._s(e.$t("message.Collections_07")))]),e._v(" "),r("h4",{staticClass:"form-item-des"},[e._v(e._s(e.$t("message.Other_15")))])]),e._v(" "),r("el-input",{attrs:{maxlength:64},model:{value:e.form.sUrl,callback:function(t){e.$set(e.form,"sUrl",t)},expression:"form.sUrl"}},[r("template",{slot:"prepend"},[e._v("https://erax.io/assets/")])],2)],1),e._v(" "),r("el-form-item",{staticClass:"form-item",attrs:{prop:"sDescription"}},[r("div",{staticClass:"form-item-header"},[r("h4",{staticClass:"form-item-title"},[e._v(e._s(e.$t("message.Collections_08"))+" *")]),e._v(" "),r("h4",{staticClass:"form-item-des"},[e._v(e._s(e.$t("message.Other_13")))])]),e._v(" "),r("VueUeditorWrap",{attrs:{destroy:!0,config:e.myConfig},model:{value:e.form.sDescription,callback:function(t){e.$set(e.form,"sDescription",t)},expression:"form.sDescription"}})],1),e._v(" "),r("el-form-item",{staticClass:"form-item",attrs:{prop:"iCategory"}},[r("div",{staticClass:"form-item-header"},[r("h4",{staticClass:"form-item-title"},[e._v(e._s(e.$t("message.Other_05"))+" *")]),e._v(" "),r("h4",{staticClass:"form-item-des"},[e._v(e._s(e.$t("message.Other_16")))])]),e._v(" "),r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("message.assets_lang_74")},model:{value:e.form.iCategory,callback:function(t){e.$set(e.form,"iCategory",t)},expression:"form.iCategory"}},[e.form.iCategory||0===e.form.iCategory?r("img",{staticClass:"select-icon",attrs:{slot:"prefix",src:e.eraxDictDatas[e.form.iCategory].sDictIcon},slot:"prefix"}):e._e(),e._v(" "),e._l(e.eraxDictData,function(t){return r("el-option",{key:t.iDictSort,attrs:{label:e.$t(t.sDictText),value:t.iDictSort}},[r("p",{staticClass:"item-icon-select"},[r("img",{attrs:{src:t.sDictIcon}}),e._v(" "),r("span",[e._v(e._s(e.$t(t.sDictText)))])])])})],2)],1),e._v(" "),r("el-form-item",{staticClass:"form-item"},[r("div",{staticClass:"form-item-header"},[r("h4",{staticClass:"form-item-title"},[e._v(e._s(e.$t("message.Other_09")))])]),e._v(" "),r("div",{staticClass:"erax-input-group"},e._l(e.form.vLinks,function(t,s){return r("el-input",{key:t.sKey,attrs:{maxlength:200},model:{value:e.form.vLinks[s].sUrl,callback:function(t){e.$set(e.form.vLinks[s],"sUrl",t)},expression:"form.vLinks[i].sUrl"}},[r("template",{slot:"prepend"},[r("i",{class:t.sIcon})])],2)}),1)])],1),e._v(" "),r("div",{staticClass:"form-item-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticClass:"form-btn edit",on:{click:e.handleEdit}},[e._v(e._s(e.$t("message.Accounts_29")))]),e._v(" "),r("el-button",{staticClass:"form-btn delete",on:{click:e.handleDelete}},[e._v(e._s(e.$t("message.Other_17")))])],1)],1)])},staticRenderFns:[]};var v=r("VU/8")(u,f,!1,function(e){r("T6vj")},"data-v-1988def8",null);t.default=v.exports}});